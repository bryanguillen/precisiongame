<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
    <title>Precision Video Game</title>
    <style>
    	* { padding: 0; margin: 0; }
    	canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>
	<canvas id="myCanvas" width="500" height="350" style="border: 1px solid red;"></canvas>
	<script>
		//Get canvas element off of dom
		var canvas = document.getElementById("myCanvas");
		//paintbrush initialization (ctx convention)
		var ctx = canvas.getContext("2d");
		//halves
		var width = canvas.width;
		var height = canvas.height;
		//initializing coordinates before gameplay
		var startX = width/2;
		var startY = height/2;
		//var for y coordinates after shot fired and on.
		var x = 250;
		var y = height-5;
		//change in x & y for change in frames while in gameplay
		var dx = 2;
		var dy = -2; 
		//event triggers 
		var rightPressed = false;
		var leftPressed = false;
		var shotFired = false;
		//variables for gameplay and shapes 
		var ballRadius = 5;
		var gunAngle = 0;
		//saving the gunangles 
		var angleArray = [];

		document.addEventListener("keydown", keydownHandler, false);
		document.addEventListener("keyup", keyupHandler, false);

		function keydownHandler(e){
			if(e.keyCode == 39){
				rightPressed = true;
			}else if(e.keyCode == 37){
				leftPressed = true;
			}else if(e.keyCode == 32){
				shotFired = true;
			}
		}

		function keyupHandler(e){
			if(e.keyCode == 39){
				rightPressed = false;
			}else if(e.keyCode == 37){
				leftPressed = false;
			}else if(e.keyCode == 32){
				shotFired = false;
			}
		}
		
		//startVector allows the user to see trajectory before shot
		function startVector(angle){
			ctx.clearRect(0, 0, width, height);
			//save the prior context
			ctx.save();
			
			ctx.beginPath();
			
			//[0,0] is now at [250,350], lower center of canvas
			ctx.translate(250,350);
			ctx.rotate(gunAngle*Math.PI/180);
			ctx.moveTo(0,0);
			ctx.lineTo(0,-30);
			ctx.stroke();
			
			//bring back the normalized context plane.
			ctx.restore();
		}

		//setShotAngle for the trajectory of ball through gameplay
		function setShotAngle(){
			ctx.clearRect(0,0, width, height);
			startVector(gunAngle);
			if(rightPressed && gunAngle < 90){
				gunAngle += 2;
			}
			if(leftPressed && gunAngle > -90){
				gunAngle -= 2;
			}
			if(shotFired){
				//stop the loop to collect the angle
				clearInterval(angleLoop);
				//add angle for later reference
				angleArray.push(gunAngle);
			}
		}		

		/*** NOW!
		What you have to do is, take the gunAngle, and then 
		with that, somehow affect the trajectory of the ball. 
		Whether it is with the drawBall function or the ballInMotion 
		function
		***/
		function drawBall(){
			ctx.beginPath();
			ctx.arc(x, y, ballRadius, 0, Math.PI*2, false);
			ctx.fillStyle = "black";
			ctx.fill();
			ctx.closePath();
		}

		function ballInMotion(){
			//for not leaving a trail behind after every frame
			ctx.clearRect(0, 0, width, height);
			drawBall();
			x -= dx
			y += dy;
			if(x + dx > width-ballRadius || x + dx < ballRadius){
				dx = -dx;
			}
			if(y + dy < ballRadius){
				dy = -dy;
			} else if(y + dy > height+ballRadius){
				document.location.reload();
			}
		}
		
		var angleLoop= setInterval(setShotAngle, 10);
	</script>
</body>
</html>